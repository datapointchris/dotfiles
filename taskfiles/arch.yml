# ================================================================
# Arch Linux-Specific Tasks
# ================================================================
# Platform-specific installation and configuration for Arch Linux
# PLACEHOLDER: To be fully implemented when Arch system is set up

version: '3'

tasks:
  # ================================================================
  # PACKAGE INSTALLATION
  # ================================================================

  install-packages:
    desc: Install system packages via pacman
    cmds:
      - echo " Installing Arch Linux packages..."
      - task: update-system
      - task: install-essential
      - task: install-dev-tools
      - task: install-aur-helper
      - echo " Arch packages installed!"

  update-system:
    desc: Update pacman package database
    cmds:
      - echo " Updating package database..."
      - sudo pacman -Sy

  install-essential:
    internal: true
    silent: true
    cmds:
      - |
        echo " Installing essential tools..."
        sudo pacman -S --needed --noconfirm \
          git \
          curl \
          wget \
          base-devel

  install-dev-tools:
    internal: true
    silent: true
    cmds:
      - |
        echo " Installing development tools..."
        sudo pacman -S --needed --noconfirm \
          bat \
          eza \
          fd \
          ripgrep \
          fzf \
          zoxide \
          git-delta \
          tmux \
          neovim \
          tree \
          htop \
          jq \
          lazygit \
          yazi \
          go \
          rust \
          lua \
          luajit

  install-aur-helper:
    desc: Install yay (AUR helper)
    cmds:
      - |
        if command -v yay >/dev/null 2>&1; then
          echo " yay already installed"
        else
          echo " Installing yay AUR helper..."
          cd /tmp
          git clone https://aur.archlinux.org/yay.git
          cd yay
          makepkg -si --noconfirm
          cd ~
          rm -rf /tmp/yay
          echo " yay installed"
        fi
    status:
      - command -v yay >/dev/null 2>&1

  # ================================================================
  # AUR PACKAGES
  # ================================================================

  install-aur-packages:
    desc: Install packages from AUR
    deps:
      - install-aur-helper
    cmds:
      - |
        echo " Installing AUR packages..."

        # Install AUR packages here
        # yay -S --needed --noconfirm <package-name>

        echo " No AUR packages configured yet"
        echo " AUR packages installed!"

  # ================================================================
  # DESKTOP ENVIRONMENT (if applicable)
  # ================================================================

  install-desktop:
    desc: Install desktop environment (optional)
    cmds:
      - |
        echo " Desktop environment installation not configured"
        echo " Common options"
        echo "   - GNOME: sudo pacman -S gnome gnome-extra"
        echo "   - KDE: sudo pacman -S plasma kde-applications"
        echo "   - i3: sudo pacman -S i3-wm i3status i3lock dmenu"

  # ================================================================
  # ARCH-SPECIFIC CONFIGURATION
  # ================================================================

  configure:
    desc: Apply Arch-specific configurations
    silent: true
    cmds:
      - echo "✅ Configuring Arch Linux..."
      - task: configure-pacman
      - echo "✅ Arch configured!"

  configure-pacman:
    internal: true
    silent: true
    cmds:
      - |
        echo "  Configuring pacman..."

        # Enable color output
        sudo sed -i 's/#Color/Color/' /etc/pacman.conf

        # Enable parallel downloads
        sudo sed -i 's/#ParallelDownloads/ParallelDownloads/' /etc/pacman.conf

        echo " pacman configured"

  # ================================================================
  # UTILITIES
  # ================================================================
  # For system maintenance, use pacman directly:
  #   sudo pacman -Syu                         # Update system
  #   sudo pacman -Sc                          # Clean cache
  #   sudo pacman -Rns $(pacman -Qtdq)         # Remove orphans
  #   pacman -Q | wc -l                        # Count packages
  #   uname -r                                 # Show kernel version

  # ================================================================
  # SERVICES
  # ================================================================

  enable-services:
    desc: Enable essential services
    silent: true
    cmds:
      - |
        echo "✅ Enabling services..."

        # Network
        sudo systemctl enable NetworkManager
        sudo systemctl start NetworkManager

        # SSH (if needed)
        # sudo systemctl enable sshd
        # sudo systemctl start sshd

        echo "✅ Services enabled"
