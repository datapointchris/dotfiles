# ================================================================
# Homebrew Package Management Tasks
# ================================================================
# Platform: macOS
# Manages Homebrew packages using Brewfile

version: "3"

vars:
  BREWFILE: "{{.ROOT_DIR}}/Brewfile"
  BREWFILE_LOCK: "{{.ROOT_DIR}}/Brewfile.lock.json"

tasks:
  install:
    desc: Install all packages from Brewfile
    silent: true
    cmds:
      - task: check-brewfile
      - echo "✅ Installing Homebrew packages from Brewfile..."
      - brew bundle install --file={{.BREWFILE}}
      - echo "✅ Homebrew packages installed!"
    sources:
      - "{{.BREWFILE}}"
    generates:
      - "{{.BREWFILE_LOCK}}"

  # ================================================================
  # UPDATE
  # ================================================================

  update:
    desc: Update Homebrew and upgrade all packages
    silent: true
    cmds:
      - echo "  Updating Homebrew..."
      - brew update
      - echo "  Upgrading formulas and casks..."
      - brew upgrade
      - brew upgrade --cask --greedy
      - echo "  Homebrew packages updated"
